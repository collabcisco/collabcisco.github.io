<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Información Cliente</title>
    <!-- Google Fonts for modern typography -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet" />
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            background: #f5f7fa;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            color: #333;
        }
        header {
            background-color: #00457c;
            width: 100%;
            padding: 15px 20px;
            display: flex;
            align-items: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        header img {
            height: 50px;
            margin-right: 15px;
        }
        header h1 {
            color: #fff;
            font-weight: 700;
            font-size: 1.5rem;
            margin: 0;
        }
        main {
            background: #fff;
            margin: 40px 20px;
            padding: 30px 40px;
            border-radius: 10px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
            max-width: 600px;
            width: 100%;
            text-align: center;
            position: relative;
        }
        .loading-spinner {
            border: 5px solid #f3f3f3;
            border-top: 5px solid #00457c;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
            display: none;
        }
        @keyframes spin {
            0% { transform: rotate(0deg);}
            100% { transform: rotate(360deg);}
        }
        .info-item {
            margin: 12px 0;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        .info-item svg {
            fill: #00457c;
            width: 24px;
            height: 24px;
        }
        #no-data {
            color: #cc0000;
            font-weight: 600;
            margin-top: 20px;
        }
        #history {
            margin-top: 30px;
            text-align: left;
            border-top: 1px solid #ddd;
            padding-top: 20px;
        }
        #history h2 {
            color: #00457c;
            font-weight: 700;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }
        #history ul {
            list-style: none;
            padding-left: 0;
            max-height: 200px;
            overflow-y: auto;
        }
        #history li {
            background: #f0f4fa;
            margin-bottom: 10px;
            padding: 10px 15px;
            border-radius: 6px;
            font-size: 1rem;
        }
        #greeting {
            margin-bottom: 20px;
            font-size: 1.2rem;
            color: #00457c;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <header>
        <img src="logo-etn.png" alt="ETN Logo" />
        <h1>Información Cliente</h1>
    </header>
    <main>
        <div id="greeting"></div>
        <div id="loading" class="loading-spinner" aria-label="Cargando información"></div>
        <div id="client-info"></div>
        <div id="no-data"></div>
        <section id="history" style="display:none;">
            <h2>Historial de Viajes</h2>
            <ul id="history-list"></ul>
        </section>
    </main>

    <script>
        // Simulated client data for demonstration (replace with real API call)
        const clients = {
            "525544491355": {
                nombre: "Veronica Diaz",
                correo: "vdiazrod@cisco.com",
                boleto: "A12345",
                origen: "Monterrey",
                destino: "Ciudad de México",
                horaSalida: "08:00",
                horaLlegada: "16:00",
                tiempoViaje: "8h",
                fechaCompra: "2025-08-01",
                historial: [
                    { boleto: "Z54321", origen: "Monterrey", destino: "Guadalajara", fecha: "2025-06-10" },
                    { boleto: "Y98765", origen: "Monterrey", destino: "Querétaro", fecha: "2025-05-05" }
                ]
            },
            "525551743175": {
                nombre: "Veronica Diaz",
                correo: "vdiazrod@cisco.com",
                boleto: "B67890",
                origen: "Guadalajara",
                destino: "Ciudad de México",
                horaSalida: "10:30",
                horaLlegada: "18:30",
                tiempoViaje: "8h",
                fechaCompra: "2025-07-28",
                historial: [
                    { boleto: "X11223", origen: "Guadalajara", destino: "Monterrey", fecha: "2025-07-15" },
                    { boleto: "Y98767", origen: "Monterrey", destino: "Querétaro", fecha: "2025-06-05" }
                ]
            }
            // Agrega más clientes según sea necesario
        };

        const clientInfoDiv = document.getElementById('client-info');
        const loadingSpinner = document.getElementById('loading');
        const noDataDiv = document.getElementById('no-data');
        const historySection = document.getElementById('history');
        const historyList = document.getElementById('history-list');
        const greetingDiv = document.getElementById('greeting');

        // Íconos SVG para los datos
        const icons = {
            nombre: `<svg viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>`,
            correo: `<svg viewBox="0 0 24 24"><path d="M20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/></svg>`,
            boleto: `<svg viewBox="0 0 24 24"><path d="M20 6H4v12h16V6zm-2 10H6v-8h12v8z"/></svg>`,
            origen: `<svg viewBox="0 0 24 24"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7z"/></svg>`,
            destino: `<svg viewBox="0 0 24 24"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zM7 9c0-2.76 2.24-5 5-5s5 2.24 5 5c0 2.5-2.5 6.5-5 9.88C9.5 15.5 7 11.5 7 9z"/></svg>`,
            horaSalida: `<svg viewBox="0 0 24 24"><path d="M12 20c4.41 0 8-3.59 8-8s-3.59-8-8-8-8 3.59-8 8 3.59 8 8 8zm.5-13h-1v6l5.25 3.15.75-1.23-4.5-2.67V7z"/></svg>`,
            horaLlegada: `<svg viewBox="0 0 24 24"><path d="M12 20c4.41 0 8-3.59 8-8s-3.59-8-8-8-8 3.59-8 8 3.59 8 8 8zm.5-13h-1v6l5.25 3.15.75-1.23-4.5-2.67V7z"/></svg>`,
            tiempoViaje: `<svg viewBox="0 0 24 24"><path d="M12 4a8 8 0 1 0 8 8 8.01 8.01 0 0 0-8-8zm.5 8.25V7h-1v6l5.25 3.15.75-1.23z"/></svg>`,
            fechaCompra: `<svg viewBox="0 0 24 24"><path d="M19 4h-1V2h-2v2H8V2H6v2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V9h14v11z"/></svg>`
        };

        function getURLParameter(name) {
            const params = new URLSearchParams(window.location.search);
            return params.get(name) || null;
        }

        function displayGreeting(agentName, queue) {
            if (agentName && queue) {
                greetingDiv.textContent = `Hola agente ${agentName}. Esta llamada llegó a la cola: ${queue}`;
            } else if (agentName) {
                greetingDiv.textContent = `Hola, ${agentName}.`;
            } else {
                greetingDiv.textContent = '';
            }
        }

        function displayClientInfo(client) {
            clientInfoDiv.innerHTML = `
                <div class="info-item">${icons.nombre}<strong>Nombre:</strong> ${client.nombre}</div>
                <div class="info-item">${icons.correo}<strong>Correo Electrónico:</strong> ${client.correo}</div>
                <div class="info-item">${icons.boleto}<strong>Boleto:</strong> ${client.boleto}</div>
                <div class="info-item">${icons.origen}<strong>Origen:</strong> ${client.origen}</div>
                <div class="info-item">${icons.destino}<strong>Destino:</strong> ${client.destino}</div>
                <div class="info-item">${icons.horaSalida}<strong>Hora de Salida:</strong> ${client.horaSalida}</div>
                <div class="info-item">${icons.horaLlegada}<strong>Hora de Llegada:</strong> ${client.horaLlegada}</div>
                <div class="info-item">${icons.tiempoViaje}<strong>Tiempo de Viaje:</strong> ${client.tiempoViaje}</div>
                <div class="info-item">${icons.fechaCompra}<strong>Fecha de Compra:</strong> ${client.fechaCompra}</div>
            `;
            noDataDiv.textContent = '';

            if (client.historial && client.historial.length > 0) {
                historyList.innerHTML = '';
                client.historial.forEach(viaje => {
                    const li = document.createElement('li');
                    li.textContent = `Boleto: ${viaje.boleto} | Origen: ${viaje.origen} | Destino: ${viaje.destino} | Fecha: ${viaje.fecha}`;
                    historyList.appendChild(li);
                });
                historySection.style.display = 'block';
            } else {
                historySection.style.display = 'none';
            }
        }

        async function fetchClientData(phone) {
            loadingSpinner.style.display = 'block';
            clientInfoDiv.innerHTML = '';
            noDataDiv.textContent = '';
            historySection.style.display = 'none';
            historyList.innerHTML = '';

            return new Promise((resolve) => {
                setTimeout(() => {
                    loadingSpinner.style.display = 'none';
                    resolve(clients[phone] || null);
                }, 1200);
            });
        }

        async function init() {
            const agentName = getURLParameter('agentname');
            const queue = getURLParameter('queue');
            displayGreeting(agentName, queue);

            let phoneRaw = getURLParameter('telefono') || getURLParameter('phone') || getURLParameter('numero');
            if (!phoneRaw) {
                noDataDiv.textContent = 'No se proporcionó número telefónico en la URL.';
                return;
            }
            // Remove leading '+' if present
            const phone = phoneRaw.replace(/^\+/, '');

            const client = await fetchClientData(phone);
            if (client) {
                displayClientInfo(client);
            } else {
                noDataDiv.textContent = `No se encontró información para el número: ${phone}`;
            }
        }

        window.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>